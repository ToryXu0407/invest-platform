# ä»·å€¼æŠ•èµ„åˆ†æå¹³å° - å®Œæ•´å¼€å‘è§„æ ¼è¯´æ˜ä¹¦

**ç‰ˆæœ¬**: v2.0  
**åˆ›å»ºæ—¥æœŸ**: 2026-02-28  
**å‚è€ƒé¡¹ç›®**: DangInvest (https://dang-invest.com/)  
**çŠ¶æ€**: å¼€å‘ä¸­  

---

## ğŸ“‹ ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#1-é¡¹ç›®æ¦‚è¿°)
2. [åŠŸèƒ½éœ€æ±‚è¯¦è§£](#2-åŠŸèƒ½éœ€æ±‚è¯¦è§£)
3. [æŠ€æœ¯æ¶æ„](#3-æŠ€æœ¯æ¶æ„)
4. [æ•°æ®æºæ–¹æ¡ˆ](#4-æ•°æ®æºæ–¹æ¡ˆ)
5. [æ ¸å¿ƒæŒ‡æ ‡è®¡ç®—](#5-æ ¸å¿ƒæŒ‡æ ‡è®¡ç®—)
6. [æ•°æ®åº“è®¾è®¡](#6-æ•°æ®åº“è®¾è®¡)
7. [API è®¾è®¡](#7-api-è®¾è®¡)
8. [UI/UXè®¾è®¡](#8-uiuxè®¾è®¡)
9. [å¼€å‘è®¡åˆ’](#9-å¼€å‘è®¡åˆ’)
10. [æµ‹è¯•ç­–ç•¥](#10-æµ‹è¯•ç­–ç•¥)

---

## 1. é¡¹ç›®æ¦‚è¿°

### 1.1 é¡¹ç›®èƒŒæ™¯

å‚è€ƒ DangInvest å¹³å°ï¼Œå¼€å‘ä¸€ä¸ªåŸºäºä»·å€¼æŠ•èµ„ç†å¿µçš„è‚¡ç¥¨åˆ†æå¹³å°ï¼Œå°† @MR Dang çš„æŠ•èµ„ç†å¿µé‡åŒ–ä¸ºå¯æ“ä½œçš„å·¥å…·ã€‚

### 1.2 æ ¸å¿ƒç†å¿µ

**è‚¡æ¯ç‡é”šå®š**: ä»¥è‚¡æ¯ç‡ä½œä¸ºè‚¡ç¥¨ä¼°å€¼çš„æ ¸å¿ƒå‚è€ƒæŒ‡æ ‡

**å†å²ç™¾åˆ†ä½**: é€šè¿‡ PE/PB çš„å†å²ç™¾åˆ†ä½åˆ¤æ–­å½“å‰ä¼°å€¼é«˜ä½

**çœŸé’±æŒ‡æ•°**: ç»è¥ç°é‡‘æµ/å½’æ¯å‡€åˆ©æ¶¦ > 1.0 è¡¨ç¤ºåˆ©æ¶¦è´¨é‡é«˜

### 1.3 ç›®æ ‡ç”¨æˆ·ç”»åƒ

| ç”¨æˆ·ç±»å‹ | ç‰¹å¾ | æ ¸å¿ƒéœ€æ±‚ |
|---------|------|---------|
| ä»·å€¼æŠ•èµ„åˆå­¦è€… | å­¦ä¹ æŠ•èµ„çŸ¥è¯†ï¼Œç¼ºä¹åˆ†æå·¥å…· | ç³»ç»Ÿçš„å­¦ä¹ èµ„æº + ç®€å•çš„åˆ†æå·¥å…· |
| ä¸ªäººæŠ•èµ„è€… | æœ‰ä¸€å®šç»éªŒï¼Œéœ€è¦æ•°æ®æ”¯æŒ | å¿«é€Ÿç­›é€‰æ ‡çš„ + ä¼°å€¼å‚è€ƒ |
| è´¢åŠ¡åˆ†æçˆ±å¥½è€… | å–œæ¬¢ç ”ç©¶è´¢æŠ¥æ•°æ® | è¯¦ç»†çš„è´¢åŠ¡æ•°æ®å¯è§†åŒ– |
| Dang ç†å¿µè¿½éšè€… | è®¤åŒ@MR Dang æŠ•èµ„ç†å¿µ | é‡åŒ–çš„æŠ•èµ„æŒ‡æ ‡ + æ–‡ç« çŸ¥è¯†åº“ |

### 1.4 ç«å“åˆ†æï¼ˆDangInvestï¼‰

**æ ¸å¿ƒåŠŸèƒ½**:
- âœ… è‚¡ç¥¨åˆ†æï¼šè‚¡æ¯ç‡é”šå®šã€PE/PB ç™¾åˆ†ä½ã€çœŸé’±æŒ‡æ•°
- âœ… æ–‡ç« åº“ï¼š213 ç¯‡@MR Dang æ–‡ç« ï¼Œæ”¯æŒæœç´¢å’Œåˆ†ç±»
- âœ… AI é—®ç­”ï¼šåŸºäº RAG çš„æ™ºèƒ½é—®ç­”
- âœ… ä»·æ ¼é¢„è­¦ï¼šå¤šç»´åº¦é¢„è­¦ï¼Œæ”¯æŒå¾®ä¿¡æ¨é€
- âœ… é€‰è‚¡å™¨ï¼šå¤šæŒ‡æ ‡ç­›é€‰

**å¯æ”¹è¿›ç‚¹**:
- ğŸ“Š æ›´ä¸°å¯Œçš„å›¾è¡¨å±•ç¤º
- ğŸ¤– æ›´æ™ºèƒ½çš„ AI æ¨è
- ğŸ“± ç§»åŠ¨ç«¯é€‚é…
- ğŸ”” æ›´å¤šé€šçŸ¥æ¸ é“

---

## 2. åŠŸèƒ½éœ€æ±‚è¯¦è§£

### 2.1 è‚¡ç¥¨åˆ†ææ¨¡å—

#### 2.1.1 è‚¡ç¥¨æœç´¢

**åŠŸèƒ½æè¿°**: æ”¯æŒä»£ç /åç§°/æ‹¼éŸ³æœç´¢ A è‚¡/æ¸¯è‚¡/ç¾è‚¡

**æŠ€æœ¯å®ç°**:
```python
# åç«¯ API
GET /api/v1/stocks/search?q={query}&market={market}&page=1&page_size=20

# æœç´¢é€»è¾‘
- æ”¯æŒä»£ç ç²¾ç¡®åŒ¹é… (600519, 00700, AAPL)
- æ”¯æŒåç§°æ¨¡ç³ŠåŒ¹é… (è´µå·èŒ…å°ï¼Œè…¾è®¯)
- æ”¯æŒæ‹¼éŸ³é¦–å­—æ¯ (GZMT, TX)
- æ”¯æŒå¸‚åœºç­›é€‰ (A è‚¡/æ¸¯è‚¡/ç¾è‚¡)
```

**UI äº¤äº’**:
- æœç´¢æ¡†æ”¯æŒè‡ªåŠ¨è¡¥å…¨
- æœç´¢ç»“æœå±•ç¤ºè‚¡ç¥¨å¡ç‰‡ï¼ˆä»£ç ã€åç§°ã€å½“å‰ä»·ã€æ¶¨è·Œå¹…ï¼‰
- æ”¯æŒé”®ç›˜å¿«é€Ÿé€‰æ‹©

#### 2.1.2 è‚¡ç¥¨è¯¦æƒ…é¡µ

**é¡µé¢ç»“æ„**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è‚¡ç¥¨å¤´éƒ¨                                   â”‚
â”‚ 600519.SH  è´µå·èŒ…å°  +è‡ªé€‰  +é¢„è­¦          â”‚
â”‚ 1678.50  +1.25%  æ¶¨ 20.50                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ ¸å¿ƒæŒ‡æ ‡å¡ç‰‡åŒº                              â”‚
â”‚ [è‚¡æ¯ç‡] [PE-TTM] [PB] [çœŸé’±æŒ‡æ•°] [å¸‚å€¼]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ K çº¿å›¾è¡¨åŒº                                  â”‚
â”‚ [æ—¥ K] [å‘¨ K] [æœˆ K]  + æŒ‡æ ‡ [MA][VOL]      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ä¼°å€¼åˆ†æåŒº                                  â”‚
â”‚ PE ç™¾åˆ†ä½å†å²èµ°åŠ¿å›¾è¡¨                        â”‚
â”‚ PB ç™¾åˆ†ä½å†å²èµ°åŠ¿å›¾è¡¨                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è´¢åŠ¡æ•°æ®åŒº                                  â”‚
â”‚ [è¥æ”¶] [å‡€åˆ©æ¶¦] [ROE] [ç°é‡‘æµ] å›¾è¡¨          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è‚¡æ¯åˆ†æåŒº                                  â”‚
â”‚ å†å¹´è‚¡æ¯ç‡è¡¨æ ¼ + åˆ†çº¢è®°å½•                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ¸å¿ƒæŒ‡æ ‡å¡ç‰‡**:
| æŒ‡æ ‡ | æ˜¾ç¤ºå†…å®¹ | é¢œè‰²é€»è¾‘ |
|-----|---------|---------|
| è‚¡æ¯ç‡ | å½“å‰å€¼ + å†å²ç™¾åˆ†ä½ | >5% ç»¿è‰²ï¼Œ<2% çº¢è‰² |
| PE-TTM | å½“å‰å€¼ + å†å²ç™¾åˆ†ä½ | <20% ç»¿è‰²ï¼Œ>80% çº¢è‰² |
| PB | å½“å‰å€¼ + å†å²ç™¾åˆ†ä½ | <20% ç»¿è‰²ï¼Œ>80% çº¢è‰² |
| çœŸé’±æŒ‡æ•° | ç»è¥ç°é‡‘æµ/å‡€åˆ©æ¶¦ | >1.0 ç»¿è‰²ï¼Œ<0.5 çº¢è‰² |
| å¸‚å€¼ | å½“å‰æ€»å¸‚å€¼ | - |

#### 2.1.3 è‚¡æ¯ç‡åˆ†æ

**æ•°æ®éœ€æ±‚**:
- å†å²è‚¡æ¯æ•°æ®ï¼ˆå¹´åº¦/ä¸­æœŸåˆ†çº¢ï¼‰
- å†å²è‚¡ä»·æ•°æ®
- è‚¡æ¯ç‡è®¡ç®—ï¼šå¹´åº¦è‚¡æ¯ / å½“å‰è‚¡ä»·

**å±•ç¤ºå†…å®¹**:
```
è‚¡æ¯ç‡åˆ†æ
â”œâ”€â”€ å½“å‰è‚¡æ¯ç‡ï¼š1.85%
â”œâ”€â”€ å†å²ç™¾åˆ†ä½ï¼š45.2%ï¼ˆè¿‘ 10 å¹´ï¼‰
â”œâ”€â”€ è¿‘ 5 å¹´å¹³å‡ï¼š2.1%
â”œâ”€â”€ è‚¡æ¯ç‡èµ°åŠ¿å›¾è¡¨ï¼ˆ10 å¹´ï¼‰
â””â”€â”€ åˆ†çº¢è®°å½•è¡¨æ ¼
    â”œâ”€â”€ 2023 å¹´ï¼šæ¯ 10 è‚¡æ´¾ 259.11 å…ƒ
    â”œâ”€â”€ 2022 å¹´ï¼šæ¯ 10 è‚¡æ´¾ 216.78 å…ƒ
    â””â”€â”€ ...
```

#### 2.1.4 PE/PB ç™¾åˆ†ä½

**è®¡ç®—é€»è¾‘**:
```python
def calculate_percentile(current_value: float, historical_data: List[float]) -> float:
    """
    è®¡ç®—å½“å‰å€¼åœ¨å†å²æ•°æ®ä¸­çš„ç™¾åˆ†ä½
    ç™¾åˆ†ä½ = (å†å²ä¸­å°äºå½“å‰å€¼çš„æ•°é‡ / æ€»æ•°é‡) * 100
    """
    count_lower = sum(1 for v in historical_data if v < current_value)
    return (count_lower / len(historical_data)) * 100
```

**å±•ç¤ºå†…å®¹**:
- å½“å‰ PE/PB å€¼
- å†å²ç™¾åˆ†ä½ï¼ˆè¿‘ 5 å¹´/10 å¹´ï¼‰
- ç™¾åˆ†ä½èµ°åŠ¿å›¾è¡¨
- ä¼°å€¼åŒºé—´æ ‡æ³¨ï¼ˆä½ä¼°/åˆç†/é«˜ä¼°ï¼‰

**ä¼°å€¼åŒºé—´**:
| ç™¾åˆ†ä½ | ä¼°å€¼çŠ¶æ€ | é¢œè‰² |
|-------|---------|------|
| 0-20% | ä½ä¼° | ç»¿è‰² |
| 20-50% | åä½ | æµ…ç»¿ |
| 50-80% | åˆç† | ç°è‰² |
| 80-90% | åé«˜ | æµ…çº¢ |
| 90-100% | é«˜ä¼° | çº¢è‰² |

#### 2.1.5 çœŸé’±æŒ‡æ•°

**å®šä¹‰**: ç»è¥ç°é‡‘æµ / å½’æ¯å‡€åˆ©æ¶¦

**è®¡ç®—é€»è¾‘**:
```python
def calculate_true_money_index(operating_cash_flow: float, net_profit: float) -> float:
    """
    çœŸé’±æŒ‡æ•° = ç»è¥ç°é‡‘æµ / å½’æ¯å‡€åˆ©æ¶¦
    > 1.0: åˆ©æ¶¦è´¨é‡é«˜ï¼ˆçœŸé‡‘ç™½é“¶ï¼‰
    0.5-1.0: åˆ©æ¶¦è´¨é‡ä¸€èˆ¬
    < 0.5: åˆ©æ¶¦è´¨é‡å·®ï¼ˆçº¸é¢å¯Œè´µï¼‰
    """
    if net_profit == 0:
        return 0
    return operating_cash_flow / net_profit
```

**æ•°æ®æ¥æº**: è´¢åŠ¡æŠ¥è¡¨ - ç°é‡‘æµé‡è¡¨ + åˆ©æ¶¦è¡¨

---

### 2.2 æ–‡ç« çŸ¥è¯†åº“æ¨¡å—

#### 2.2.1 æ–‡ç« åˆ†ç±»ä½“ç³»

å‚è€ƒ DangInvest çš„åˆ†ç±»ï¼š

```
æ–‡ç« åº“
â”œâ”€â”€ å¤©é˜¶åŠŸæ³•ï¼ˆé«˜çº§ï¼‰
â”‚   â”œâ”€â”€ æŠ•èµ„å“²å­¦
â”‚   â”œâ”€â”€ ä¼°å€¼æ–¹æ³•
â”‚   â””â”€â”€ å®æˆ˜æ¡ˆä¾‹
â”œâ”€â”€ åœ°é˜¶åŠŸæ³•ï¼ˆæ ¸å¿ƒï¼‰
â”‚   â”œâ”€â”€ è‚¡æ¯ç‡é”šå®š
â”‚   â”œâ”€â”€ è´¢åŠ¡åˆ†æ
â”‚   â”œâ”€â”€ ä¼°å€¼æŠ€å·§
â”‚   â””â”€â”€ é€‰è‚¡æ–¹æ³•
â””â”€â”€ ç„é˜¶åŠŸæ³•ï¼ˆåŸºç¡€ï¼‰
    â”œâ”€â”€ æŠ•èµ„å…¥é—¨
    â”œâ”€â”€ åŸºç¡€æ¦‚å¿µ
    â””â”€â”€ å¸¸è§è¯¯åŒº
```

#### 2.2.2 æ–‡ç« åŠŸèƒ½

| åŠŸèƒ½ | æè¿° | ä¼˜å…ˆçº§ |
|-----|------|--------|
| æ–‡ç« åˆ—è¡¨ | æ—¶é—´çº¿/åˆ†ç±»/æ ‡ç­¾æµè§ˆ | P0 |
| æ–‡ç« è¯¦æƒ… | å¯Œæ–‡æœ¬é˜…è¯»ï¼Œæ”¯æŒä»£ç å—/è¡¨æ ¼ | P0 |
| å…¨æ–‡æœç´¢ | Elasticsearch å…¨æ–‡æ£€ç´¢ | P1 |
| é˜…è¯»è¿›åº¦ | å·²è¯»/å¾…é˜…/æ”¶è—æ ‡è®° | P1 |
| æ–‡ç« å…³è” | ç›¸å…³æ–‡ç« æ¨è | P2 |
| æ–‡ç« å¯¼å…¥ | ä»çŸ¥ä¹/å¾®ä¿¡å¯¼å…¥ | P2 |

#### 2.2.3 é˜…è¯»çŠ¶æ€ç®¡ç†

**æœªç™»å½•ç”¨æˆ·**:
- é˜…è¯»çŠ¶æ€ä¿å­˜åœ¨æœ¬åœ°ï¼ˆLocalStorageï¼‰
- æ¸…ç†ç¼“å­˜ä¼šä¸¢å¤±

**å·²ç™»å½•ç”¨æˆ·**:
- é˜…è¯»çŠ¶æ€äº‘ç«¯åŒæ­¥
- æ”¯æŒå¤šè®¾å¤‡åŒæ­¥

**çŠ¶æ€ç±»å‹**:
```typescript
enum ReadingStatus {
  TODO = 'todo',      // å¾…é˜…
  READING = 'reading', // é˜…è¯»ä¸­
  READ = 'read',      // å·²è¯»
  BOOKMARKED = 'bookmarked' // æ”¶è—
}
```

---

### 2.3 AI é—®ç­”æ¨¡å—

#### 2.3.1 RAG æ¶æ„

```
ç”¨æˆ·é—®é¢˜
    â†“
[é—®é¢˜ç†è§£] â†’ [æ„å›¾è¯†åˆ«]
    â†“
[å‘é‡æ£€ç´¢] â†’ ä»æ–‡ç« åº“æ£€ç´¢ç›¸å…³ç‰‡æ®µ
    â†“
[ä¸Šä¸‹æ–‡ç»„è£…] â†’ é—®é¢˜ + æ£€ç´¢ç»“æœ
    â†“
[LLM ç”Ÿæˆ] â†’ GPT-4/Claude ç”Ÿæˆç­”æ¡ˆ
    â†“
[ç­”æ¡ˆ + å¼•ç”¨æ¥æº] â†’ è¿”å›ç”¨æˆ·
```

#### 2.3.2 åŠŸèƒ½ç‰¹æ€§

| åŠŸèƒ½ | æè¿° |
|-----|------|
| æ™ºèƒ½é—®ç­” | åŸºäºæŠ•èµ„çŸ¥è¯†åº“å›ç­”é—®é¢˜ |
| å¤šè½®å¯¹è¯ | æ”¯æŒä¸Šä¸‹æ–‡å¯¹è¯ |
| å¼•ç”¨æ¥æº | ç­”æ¡ˆæ ‡æ³¨æ–‡ç« å‡ºå¤„ |
| é—®ç­”å†å² | ä¿å­˜ç”¨æˆ·é—®ç­”è®°å½• |
| æ¨èé—®é¢˜ | æ ¹æ®å½“å‰é¡µé¢æ¨èç›¸å…³é—®é¢˜ |

#### 2.3.3 ç¤ºä¾‹é—®ç­”

```
ç”¨æˆ·ï¼šè´µå·èŒ…å°ç°åœ¨çš„ä¼°å€¼é«˜å—ï¼Ÿ

AI: æ ¹æ®æœ€æ–°æ•°æ®ï¼Œè´µå·èŒ…å° (600519) çš„ä¼°å€¼æƒ…å†µå¦‚ä¸‹ï¼š

1. **PE-TTM**: 28.5 å€ï¼Œå†å²ç™¾åˆ†ä½ 45.2%ï¼ˆè¿‘ 10 å¹´ï¼‰
   - å¤„äºåˆç†åŒºé—´ï¼Œä¸ç®—é«˜ä¼°ä¹Ÿä¸ç®—ä½ä¼°

2. **PB**: 7.2 å€ï¼Œå†å²ç™¾åˆ†ä½ 38.7%
   - åä½ä¼°åŒºåŸŸ

3. **è‚¡æ¯ç‡**: 1.85%
   - ä½äº 5% çš„é”šå®šæ ‡å‡†ï¼Œå¸å¼•åŠ›ä¸€èˆ¬

**ç»¼åˆåˆ¤æ–­**: å½“å‰ä¼°å€¼å¤„äºåˆç†åŒºé—´ï¼Œä¸ç®—é«˜ä¼°ã€‚
ä½†ä»è‚¡æ¯ç‡é”šå®šè§’åº¦çœ‹ï¼Œå¸å¼•åŠ›ä¸è¶³ã€‚

ğŸ“š å‚è€ƒæ–‡ç« :
- ã€Šåœ°é˜¶åŠŸæ³•ï¼šè‚¡æ¯ç‡é”šå®šæ³•ã€‹
- ã€Šå¦‚ä½•åˆ¤æ–­è‚¡ç¥¨ä¼°å€¼é«˜ä½ã€‹
```

---

### 2.4 ä»·æ ¼é¢„è­¦æ¨¡å—

#### 2.4.1 é¢„è­¦ç±»å‹

| ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|-----|------|------|
| è‚¡æ¯ç‡é¢„è­¦ | è‚¡æ¯ç‡è¾¾åˆ°è®¾å®šå€¼ | è‚¡æ¯ç‡ > 5% |
| PE é¢„è­¦ | PE è¾¾åˆ°è®¾å®šå€¼ | PE < 20 |
| PB é¢„è­¦ | PB è¾¾åˆ°è®¾å®šå€¼ | PB < 1 |
| ä»·æ ¼é¢„è­¦ | è‚¡ä»·è¾¾åˆ°è®¾å®šå€¼ | è‚¡ä»· < 100 å…ƒ |
| ç™¾åˆ†ä½é¢„è­¦ | ä¼°å€¼ç™¾åˆ†ä½è¾¾åˆ°è®¾å®šå€¼ | PE ç™¾åˆ†ä½ < 20% |

#### 2.4.2 é¢„è­¦æ¡ä»¶

```typescript
interface AlertCondition {
  type: 'dividend' | 'pe' | 'pb' | 'price' | 'percentile';
  operator: 'gt' | 'lt' | 'eq' | 'gte' | 'lte';  // > < = >= <=
  threshold: number;
}

// ç¤ºä¾‹
{
  type: 'dividend',
  operator: 'gt',
  threshold: 5  // è‚¡æ¯ç‡ > 5%
}
```

#### 2.4.3 é€šçŸ¥æ¸ é“

| æ¸ é“ | å®ç°æ–¹å¼ | ä¼˜å…ˆçº§ |
|-----|---------|--------|
| ç«™å†…ä¿¡ | æ•°æ®åº“å­˜å‚¨ + å‰ç«¯è½®è¯¢ | P0 |
| é‚®ä»¶ | SMTP å‘é€ | P1 |
| å¾®ä¿¡ | ä¼ä¸šå¾®ä¿¡æœºå™¨äºº/å…¬ä¼—å· | P1 |
| çŸ­ä¿¡ | é˜¿é‡Œäº‘çŸ­ä¿¡ | P2 |

#### 2.4.4 é¢„è­¦æ£€æŸ¥ä»»åŠ¡

```python
# Celery å®šæ—¶ä»»åŠ¡ - æ¯å¤©æ”¶ç›˜åæ£€æŸ¥
@app.task(name='tasks.check_alerts')
def check_alerts_task():
    """
    æ£€æŸ¥æ‰€æœ‰å¯ç”¨çš„é¢„è­¦æ¡ä»¶
    è§¦å‘æ¡ä»¶æ—¶å‘é€é€šçŸ¥
    """
    alerts = get_enabled_alerts()
    for alert in alerts:
        current_value = get_stock_indicator(alert.stock_code, alert.type)
        if check_condition(current_value, alert.condition, alert.threshold):
            send_alert_notification(alert, current_value)
            update_last_triggered(alert.id)
```

---

### 2.5 é€‰è‚¡å™¨æ¨¡å—

#### 2.5.1 ç­›é€‰æ¡ä»¶

**ä¼°å€¼æŒ‡æ ‡**:
- PE-TTM: æœ€å°å€¼/æœ€å¤§å€¼/ç™¾åˆ†ä½
- PB: æœ€å°å€¼/æœ€å¤§å€¼/ç™¾åˆ†ä½
- è‚¡æ¯ç‡ï¼šæœ€å°å€¼

**è´¢åŠ¡æŒ‡æ ‡**:
- ROE: æœ€å°å€¼
- è¥æ”¶å¢é•¿ç‡ï¼šæœ€å°å€¼
- å‡€åˆ©æ¶¦å¢é•¿ç‡ï¼šæœ€å°å€¼
- çœŸé’±æŒ‡æ•°ï¼šæœ€å°å€¼

**å¸‚å€¼**:
- æ€»å¸‚å€¼ï¼šèŒƒå›´

**å¸‚åœº/è¡Œä¸š**:
- å¸‚åœºï¼šA è‚¡/æ¸¯è‚¡/ç¾è‚¡
- è¡Œä¸šï¼šå¤šé€‰

#### 2.5.2 é¢„è®¾æ¨¡æ¿

```python
PRESETS = [
    {
        "id": "high_dividend",
        "name": "é«˜è‚¡æ¯ç­–ç•¥",
        "description": "è‚¡æ¯ç‡ > 5%, PE < 20, è¿ç»­ 3 å¹´åˆ†çº¢",
        "conditions": {
            "dividend_yield_min": 5,
            "pe_max": 20,
            "consecutive_dividend_years_min": 3
        }
    },
    {
        "id": "low_valuation",
        "name": "ä½ä¼°å€¼ç­–ç•¥",
        "description": "PE ç™¾åˆ†ä½ < 20%, PB ç™¾åˆ†ä½ < 20%",
        "conditions": {
            "pe_percentile_max": 20,
            "pb_percentile_max": 20
        }
    },
    {
        "id": "quality_growth",
        "name": "ä¼˜è´¨æˆé•¿ç­–ç•¥",
        "description": "ROE > 15%, è¥æ”¶å¢é•¿ç‡ > 20%",
        "conditions": {
            "roe_min": 15,
            "revenue_growth_min": 20
        }
    },
    {
        "id": "true_money",
        "name": "çœŸé’±ç­–ç•¥",
        "description": "çœŸé’±æŒ‡æ•° > 1.0, è¿ç»­ 5 å¹´æ­£ç°é‡‘æµ",
        "conditions": {
            "true_money_index_min": 1.0,
            "positive_cash_flow_years_min": 5
        }
    }
]
```

#### 2.5.3 é€‰è‚¡ç»“æœ

**å±•ç¤ºå†…å®¹**:
- è‚¡ç¥¨ä»£ç /åç§°
- å½“å‰ä»·æ ¼
- æ ¸å¿ƒæŒ‡æ ‡ï¼ˆPE/PB/è‚¡æ¯ç‡/ROEï¼‰
- åŒ¹é…çš„æ¡ä»¶é«˜äº®

**æ“ä½œ**:
- å¯¼å‡º CSV/Excel
- åŠ å…¥è‡ªé€‰
- æ‰¹é‡è®¾ç½®é¢„è­¦
- ä¿å­˜é€‰è‚¡æ–¹æ¡ˆ

---

### 2.6 ç”¨æˆ·ç³»ç»Ÿ

#### 2.6.1 ç”¨æˆ·ç­‰çº§

| ç­‰çº§ | æƒç›Š | è·å–æ–¹å¼ |
|-----|------|---------|
| æ¸¸å®¢ | æµè§ˆåŸºç¡€åŠŸèƒ½ | æ— éœ€æ³¨å†Œ |
| æ³¨å†Œç”¨æˆ· | è‡ªé€‰è‚¡ã€é¢„è­¦ã€é˜…è¯»çŠ¶æ€åŒæ­¥ | å…è´¹æ³¨å†Œ |
| VIPï¼ˆæœªæ¥ï¼‰ | é«˜çº§é€‰è‚¡ã€æ›´å¤šé¢„è­¦æ•°é‡ | ä»˜è´¹è®¢é˜… |

#### 2.6.2 è®¤è¯æ–¹å¼

- é‚®ç®± + å¯†ç 
- æ‰‹æœºå· + éªŒè¯ç ï¼ˆæœªæ¥ï¼‰
- ç¬¬ä¸‰æ–¹ç™»å½•ï¼ˆGitHub/å¾®ä¿¡ï¼Œæœªæ¥ï¼‰

---

## 3. æŠ€æœ¯æ¶æ„

### 3.1 æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç”¨æˆ·å±‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚  â”‚ Web ç«¯  â”‚  â”‚ ç§»åŠ¨ç«¯  â”‚  â”‚ å°ç¨‹åº  â”‚                      â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚           â”‚           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CDN / Nginx                                â”‚
â”‚                   (Cloudflare)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       åº”ç”¨å±‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚   Next.js 14    â”‚         â”‚   FastAPI       â”‚             â”‚
â”‚  â”‚   (å‰ç«¯)        â”‚â—„â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   (åç«¯ API)    â”‚             â”‚
â”‚  â”‚   http://:3000  â”‚  HTTP   â”‚   http://:8000  â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       æ•°æ®å±‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚PostgreSQLâ”‚  â”‚  Redis   â”‚  â”‚Meili/    â”‚  â”‚  å¯¹è±¡å­˜å‚¨    â”‚ â”‚
â”‚  â”‚(ä¸»æ•°æ®åº“)â”‚  â”‚ (ç¼“å­˜)   â”‚  â”‚Elastic   â”‚  â”‚  (å›¾ç‰‡/æ–‡ä»¶) â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å¤–éƒ¨æœåŠ¡å±‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Tushare  â”‚  â”‚ æ–°æµªè´¢ç» â”‚  â”‚ å¤§æ¨¡å‹   â”‚  â”‚ é‚®ä»¶/å¾®ä¿¡    â”‚ â”‚
â”‚  â”‚ (æ•°æ®)   â”‚  â”‚ (è¡Œæƒ…)   â”‚  â”‚ (AI)     â”‚  â”‚ (é€šçŸ¥)       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 æŠ€æœ¯æ ˆè¯¦æƒ…

#### å‰ç«¯
| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|-----|------|------|
| Next.js | 14.x | React å…¨æ ˆæ¡†æ¶ |
| TypeScript | 5.x | ç±»å‹å®‰å…¨ |
| Tailwind CSS | 3.x | æ ·å¼ |
| shadcn/ui | latest | UI ç»„ä»¶åº“ |
| TanStack Query | 5.x | æ•°æ®è¯·æ±‚ |
| Zustand | 4.x | çŠ¶æ€ç®¡ç† |
| Recharts | 2.x | å›¾è¡¨ |
| Lightweight Charts | 4.x | K çº¿å›¾ |

#### åç«¯
| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|-----|------|------|
| FastAPI | 0.109.x | Web æ¡†æ¶ |
| Python | 3.11+ | è¯­è¨€ |
| SQLAlchemy | 2.x | ORM |
| Pydantic | 2.x | æ•°æ®éªŒè¯ |
| Alembic | latest | æ•°æ®åº“è¿ç§» |
| Celery | 5.x | ä»»åŠ¡é˜Ÿåˆ— |
| Redis | 7.x | ç¼“å­˜ |

#### åŸºç¡€è®¾æ–½
| æœåŠ¡ | é€‰å‹ | ç”¨é€” |
|-----|------|------|
| æ•°æ®åº“ | PostgreSQL 15+ | ä¸»æ•°æ®åº“ |
| ç¼“å­˜ | Redis 7+ | ç¼“å­˜/ä¼šè¯ |
| æœç´¢ | Meilisearch | å…¨æ–‡æ£€ç´¢ |
| éƒ¨ç½² | Vercel + Railway | äº‘å¹³å° |
| ç›‘æ§ | Sentry | é”™è¯¯ç›‘æ§ |

---

## 4. æ•°æ®æºæ–¹æ¡ˆ

### 4.1 è‚¡ç¥¨æ•°æ®æº

#### A è‚¡æ•°æ®

| æ•°æ®æº | ç±»å‹ | è´¹ç”¨ | ç¨³å®šæ€§ | æ¨èåº¦ |
|-------|------|------|--------|--------|
| Tushare Pro | API | å…è´¹/ä»˜è´¹ | é«˜ | â­â­â­â­â­ |
| AkShare | API | å…è´¹ | ä¸­ | â­â­â­â­ |
| æ–°æµªè´¢ç» | API | å…è´¹ | ä¸­ | â­â­â­ |
| ä¸œæ–¹è´¢å¯Œ | API | å…è´¹ | ä¸­ | â­â­â­ |

**æ¨èæ–¹æ¡ˆ**: Tushare Proï¼ˆä¸»ï¼‰ + AkShareï¼ˆå¤‡ç”¨ï¼‰

#### æ¸¯è‚¡æ•°æ®

| æ•°æ®æº | ç±»å‹ | è´¹ç”¨ | æ¨èåº¦ |
|-------|------|------|--------|
| å¯Œé€”ç‰›ç‰› API | API | å…è´¹ | â­â­â­â­ |
| é›…è™è´¢ç» | API | å…è´¹ | â­â­â­ |
| æ–°æµªè´¢ç»æ¸¯è‚¡ | API | å…è´¹ | â­â­â­ |

#### ç¾è‚¡æ•°æ®

| æ•°æ®æº | ç±»å‹ | è´¹ç”¨ | æ¨èåº¦ |
|-------|------|------|--------|
| é›…è™è´¢ç» | API | å…è´¹ | â­â­â­â­ |
| Alpha Vantage | API | å…è´¹/ä»˜è´¹ | â­â­â­ |

### 4.2 æ•°æ®åŒæ­¥ç­–ç•¥

```python
# Celery å®šæ—¶ä»»åŠ¡é…ç½®

# æ—¥çº¿æ•°æ® - æ¯å¤©æ”¶ç›˜åæ›´æ–°
@app.task(name='tasks.sync_daily_data')
def sync_daily_data():
    """
    A è‚¡ï¼š15:00 åæ›´æ–°
    æ¸¯è‚¡ï¼š16:00 åæ›´æ–°
    ç¾è‚¡ï¼šæ¬¡æ—¥å‡Œæ™¨æ›´æ–°
    """
    pass

# å®æ—¶è¡Œæƒ… - äº¤æ˜“æ—¶æ®µæ¯ 5 åˆ†é’Ÿæ›´æ–°
@app.task(name='tasks.sync_realtime_quote')
def sync_realtime_quote():
    """
    äº¤æ˜“æ—¶æ®µï¼šæ¯ 5 åˆ†é’Ÿæ›´æ–°
    éäº¤æ˜“æ—¶æ®µï¼šä¸æ›´æ–°
    """
    pass

# è´¢åŠ¡æ•°æ® - è´¢æŠ¥å‘å¸ƒåæ›´æ–°
@app.task(name='tasks.sync_financials')
def sync_financials():
    """
    æ£€æŸ¥è´¢æŠ¥æŠ«éœ²æ—¥æœŸ
    è‡ªåŠ¨åŒæ­¥æœ€æ–°è´¢æŠ¥æ•°æ®
    """
    pass
```

### 4.3 æ•°æ®ç¼“å­˜ç­–ç•¥

| æ•°æ®ç±»å‹ | ç¼“å­˜æ—¶é—´ | è¯´æ˜ |
|---------|---------|------|
| å®æ—¶è¡Œæƒ… | 5 åˆ†é’Ÿ | äº¤æ˜“æ—¶æ®µ |
| æ—¥çº¿æ•°æ® | 24 å°æ—¶ | æ”¶ç›˜åæ›´æ–° |
| è´¢åŠ¡æ•°æ® | 7 å¤© | è´¢æŠ¥æ›´æ–°é¢‘ç‡ä½ |
| æŒ‡æ ‡è®¡ç®— | 1 å°æ—¶ | åŸºäºç¼“å­˜æ•°æ®è®¡ç®— |

---

## 5. æ ¸å¿ƒæŒ‡æ ‡è®¡ç®—

### 5.1 è‚¡æ¯ç‡

```python
def calculate_dividend_yield(stock_code: str) -> float:
    """
    è‚¡æ¯ç‡ = å¹´åº¦è‚¡æ¯ / å½“å‰è‚¡ä»· * 100%
    
    å¹´åº¦è‚¡æ¯å–æœ€è¿‘ 12 ä¸ªæœˆçš„åˆ†çº¢æ€»å’Œ
    """
    # è·å–æœ€è¿‘ 12 ä¸ªæœˆåˆ†çº¢
    dividends = get_dividends_last_12m(stock_code)
    total_dividend = sum(d['amount'] for d in dividends)
    
    # è·å–å½“å‰è‚¡ä»·
    current_price = get_current_price(stock_code)
    
    if current_price == 0:
        return 0
    
    return (total_dividend / current_price) * 100
```

### 5.2 PE-TTM

```python
def calculate_pe_ttm(stock_code: str) -> float:
    """
    PE-TTM = æ€»å¸‚å€¼ / æœ€è¿‘ 4 å­£åº¦å‡€åˆ©æ¶¦æ€»å’Œ
    
    æˆ–è€…ï¼šè‚¡ä»· / æ¯è‚¡æ”¶ç›Š (TTM)
    """
    # è·å–æœ€è¿‘ 4 å­£åº¦å‡€åˆ©æ¶¦
    net_profits = get_net_profits_last_4quarters(stock_code)
    total_profit = sum(net_profits)
    
    # è·å–æ€»å¸‚å€¼
    market_cap = get_market_cap(stock_code)
    
    if total_profit <= 0:
        return None  # äºæŸæ—  PE
    
    return market_cap / total_profit
```

### 5.3 PB

```python
def calculate_pb(stock_code: str) -> float:
    """
    PB = æ€»å¸‚å€¼ / æœ€æ–°å‡€èµ„äº§
    
    æˆ–è€…ï¼šè‚¡ä»· / æ¯è‚¡å‡€èµ„äº§
    """
    market_cap = get_market_cap(stock_code)
    net_assets = get_latest_net_assets(stock_code)
    
    if net_assets <= 0:
        return None
    
    return market_cap / net_assets
```

### 5.4 çœŸé’±æŒ‡æ•°

```python
def calculate_true_money_index(stock_code: str, report_date: str) -> float:
    """
    çœŸé’±æŒ‡æ•° = ç»è¥ç°é‡‘æµ / å½’æ¯å‡€åˆ©æ¶¦
    
    > 1.0: åˆ©æ¶¦è´¨é‡é«˜
    0.5-1.0: åˆ©æ¶¦è´¨é‡ä¸€èˆ¬
    < 0.5: åˆ©æ¶¦è´¨é‡å·®
    """
    financials = get_financials(stock_code, report_date)
    
    operating_cash_flow = financials['operating_cash_flow']
    net_profit = financials['net_profit']
    
    if net_profit == 0:
        return 0
    
    return operating_cash_flow / net_profit
```

### 5.5 å†å²ç™¾åˆ†ä½

```python
def calculate_percentile(
    current_value: float,
    historical_data: List[float],
    days: int = 3650  # é»˜è®¤ 10 å¹´
) -> float:
    """
    è®¡ç®—å½“å‰å€¼åœ¨å†å²æ•°æ®ä¸­çš„ç™¾åˆ†ä½
    
    ç™¾åˆ†ä½ = (å†å²ä¸­å°äºå½“å‰å€¼çš„æ•°é‡ / æ€»æ•°é‡) * 100
    """
    # è¿‡æ»¤æ—¶é—´èŒƒå›´
    cutoff_date = datetime.now() - timedelta(days=days)
    filtered_data = [v for v in historical_data if v['date'] >= cutoff_date]
    
    if len(filtered_data) == 0:
        return None
    
    count_lower = sum(1 for v in filtered_data if v['value'] < current_value)
    return (count_lower / len(filtered_data)) * 100
```

---

## 6. æ•°æ®åº“è®¾è®¡

### 6.1 ER å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    User     â”‚       â”‚    Stock    â”‚       â”‚   Article   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)     â”‚       â”‚ id (PK)     â”‚       â”‚ id (PK)     â”‚
â”‚ email       â”‚       â”‚ code        â”‚       â”‚ title       â”‚
â”‚ password    â”‚       â”‚ name        â”‚       â”‚ content     â”‚
â”‚ name        â”‚       â”‚ market      â”‚       â”‚ series      â”‚
â”‚ role        â”‚       â”‚ industry    â”‚       â”‚ published_atâ”‚
â”‚ created_at  â”‚       â”‚ created_at  â”‚       â”‚ created_at  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                    â”‚                     â”‚
       â”‚ 1:N                â”‚ 1:N                 â”‚ 1:N
       â–¼                    â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ UserAlert   â”‚       â”‚StockDaily   â”‚       â”‚ ReadingStat â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)     â”‚       â”‚ id (PK)     â”‚       â”‚ id (PK)     â”‚
â”‚ user_id (FK)â”‚       â”‚ stock_id(FK)â”‚       â”‚ user_id (FK)â”‚
â”‚ stock_id(FK)â”‚       â”‚ date        â”‚       â”‚ article_id  â”‚
â”‚ type        â”‚       â”‚ open        â”‚       â”‚ status      â”‚
â”‚ threshold   â”‚       â”‚ close       â”‚       â”‚ created_at  â”‚
â”‚ created_at  â”‚       â”‚ pe_ttm      â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ dividend    â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 æ ¸å¿ƒè¡¨ç»“æ„

è¯¦è§é¡¹ç›®ä¸­çš„ Prisma Schema æˆ– SQLAlchemy æ¨¡å‹æ–‡ä»¶ã€‚

---

## 7. API è®¾è®¡

### 7.1 RESTful API è§„èŒƒ

- åŸºç¡€è·¯å¾„ï¼š`/api/v1`
- è®¤è¯ï¼šJWT Bearer Token
- å“åº”æ ¼å¼ï¼šç»Ÿä¸€å“åº”ç»“æ„
- é”™è¯¯å¤„ç†ï¼šæ ‡å‡†é”™è¯¯ç 

### 7.2 ç»Ÿä¸€å“åº”ç»“æ„

```typescript
interface ApiResponse<T> {
  success: boolean;
  data?: T;
  error?: {
    code: string;
    message: string;
    details?: any;
  };
  timestamp: string;
}
```

### 7.3 æ ¸å¿ƒ API ç«¯ç‚¹

è¯¦è§é¡¹ç›®ä¸­çš„ API è·¯ç”±æ–‡ä»¶ã€‚

---

## 8. UI/UX è®¾è®¡

### 8.1 è®¾è®¡åŸåˆ™

1. **ç®€æ´æ¸…æ™°**: ä¿¡æ¯å±‚æ¬¡åˆ†æ˜ï¼Œé¿å…æ‚ä¹±
2. **æ•°æ®å¯è§†åŒ–**: å¤šç”¨å›¾è¡¨ï¼Œå°‘ç”¨çº¯æ–‡å­—
3. **å“åº”å¼**: é€‚é…æ¡Œé¢å’Œç§»åŠ¨ç«¯
4. **æ€§èƒ½ä¼˜å…ˆ**: é¦–å±åŠ è½½ < 2 ç§’

### 8.2 é…è‰²æ–¹æ¡ˆ

```css
:root {
  /* ä¸»è‰² */
  --primary: #2563eb;
  --primary-hover: #1d4ed8;
  
  /* æ¶¨è·Œè‰² */
  --up: #dc2626;      /* çº¢æ¶¨ */
  --down: #16a34a;    /* ç»¿è·Œ */
  
  /* ä¼°å€¼è‰² */
  --undervalued: #16a34a;   /* ä½ä¼° - ç»¿ */
  --fair: #6b7280;          /* åˆç† - ç° */
  --overvalued: #dc2626;    /* é«˜ä¼° - çº¢ */
  
  /* ä¸­æ€§è‰² */
  --text: #1f2937;
  --text-light: #6b7280;
  --border: #e5e7eb;
  --background: #ffffff;
}
```

### 8.3 é¡µé¢å¸ƒå±€

**é¦–é¡µ**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Logo    æœç´¢æ¡†    ç™»å½•/æ³¨å†Œ              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å¹³å°ä»‹ç» / æ ¸å¿ƒåŠŸèƒ½ / ä½¿ç”¨æŒ‡å—           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ çƒ­é—¨è‚¡ç¥¨ / æœ€è¿‘æ›´æ–° / ç²¾é€‰æ–‡ç«            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è‚¡ç¥¨è¯¦æƒ…é¡µ**:
å‚è€ƒ 2.1.2 èŠ‚

---

## 9. å¼€å‘è®¡åˆ’

### 9.1 é‡Œç¨‹ç¢‘

| é˜¶æ®µ | æ—¶é—´ | ç›®æ ‡ | å®Œæˆåº¦ |
|-----|------|------|--------|
| Phase 0 | Week 1 | é¡¹ç›®åˆå§‹åŒ–ã€åŸºç¡€æ¶æ„ | âœ… 100% |
| Phase 1 | Week 2-3 | è‚¡ç¥¨æ•°æ®æ¥å…¥ã€æ ¸å¿ƒæŒ‡æ ‡è®¡ç®— | ğŸš§ 0% |
| Phase 2 | Week 4-5 | è‚¡ç¥¨è¯¦æƒ…é¡µã€K çº¿å›¾è¡¨ | â³ 0% |
| Phase 3 | Week 6-7 | æ–‡ç« çŸ¥è¯†åº“ã€æœç´¢ | â³ 0% |
| Phase 4 | Week 8-9 | ç”¨æˆ·ç³»ç»Ÿã€é¢„è­¦åŠŸèƒ½ | â³ 0% |
| Phase 5 | Week 10-11 | é€‰è‚¡å™¨ã€AI é—®ç­” | â³ 0% |
| Phase 6 | Week 12 | æµ‹è¯•ä¼˜åŒ–ã€éƒ¨ç½²ä¸Šçº¿ | â³ 0% |

### 9.2 Phase 1 è¯¦ç»†ä»»åŠ¡ï¼ˆWeek 2-3ï¼‰

**Week 2: æ•°æ®æºæ¥å…¥**

- [ ] Tushare API å¯¹æ¥
  - [ ] è‚¡ç¥¨åˆ—è¡¨åŒæ­¥
  - [ ] æ—¥çº¿æ•°æ®è·å–
  - [ ] è´¢åŠ¡æ•°æ®è·å–
- [ ] AkShare å¤‡ç”¨æ•°æ®æº
- [ ] æ•°æ®åŒæ­¥å®šæ—¶ä»»åŠ¡
- [ ] æ•°æ®ç¼“å­˜ç­–ç•¥

**Week 3: æ ¸å¿ƒæŒ‡æ ‡è®¡ç®—**

- [ ] è‚¡æ¯ç‡è®¡ç®—
- [ ] PE-TTM è®¡ç®—
- [ ] PB è®¡ç®—
- [ ] çœŸé’±æŒ‡æ•°è®¡ç®—
- [ ] å†å²ç™¾åˆ†ä½è®¡ç®—
- [ ] æŒ‡æ ‡ API æ¥å£
- [ ] å•å…ƒæµ‹è¯•

---

## 10. æµ‹è¯•ç­–ç•¥

### 10.1 æµ‹è¯•ç±»å‹

| ç±»å‹ | å·¥å…· | è¦†ç›–ç‡ç›®æ ‡ |
|-----|------|-----------|
| å•å…ƒæµ‹è¯• | pytest + vitest | â‰¥ 80% |
| é›†æˆæµ‹è¯• | pytest + httpx | æ ¸å¿ƒæµç¨‹ |
| E2E æµ‹è¯• | Playwright | å…³é”®ç”¨æˆ·æµç¨‹ |

### 10.2 æµ‹è¯•ç”¨ä¾‹ç¤ºä¾‹

**åç«¯æµ‹è¯•**:
```python
def test_calculate_dividend_yield():
    """æµ‹è¯•è‚¡æ¯ç‡è®¡ç®—"""
    result = calculate_dividend_yield('600519')
    assert result > 0
    assert isinstance(result, float)

@pytest.mark.asyncio
async def test_get_stock_indicators():
    """æµ‹è¯•è‚¡ç¥¨æŒ‡æ ‡ API"""
    async with AsyncClient() as client:
        response = await client.get('/api/v1/stocks/600519/indicators')
        assert response.status_code == 200
        assert 'pe_ttm' in response.json()
```

**å‰ç«¯æµ‹è¯•**:
```typescript
test('è‚¡ç¥¨æœç´¢åŠŸèƒ½', async () => {
  render(<StockSearch />)
  await user.type(screen.getByRole('searchbox'), '600519')
  expect(await screen.findByText('è´µå·èŒ…å°')).toBeInTheDocument()
})
```

---

## é™„å½•

### A. å‚è€ƒèµ„æº

- DangInvest: https://dang-invest.com/
- Tushare: https://tushare.pro/
- AkShare: https://akshare.akfamily.xyz/
- FastAPI: https://fastapi.tiangolo.com/
- Next.js: https://nextjs.org/

### B. æœ¯è¯­è¡¨

| æœ¯è¯­ | è§£é‡Š |
|-----|------|
| è‚¡æ¯ç‡ | å¹´åº¦è‚¡æ¯/è‚¡ä»·ï¼Œè¡¡é‡åˆ†çº¢å›æŠ¥ |
| PE-TTM | æ»šåŠ¨å¸‚ç›ˆç‡ï¼Œ12 ä¸ªæœˆå‡€åˆ©æ¶¦ |
| PB | å¸‚å‡€ç‡ï¼Œè‚¡ä»·/æ¯è‚¡å‡€èµ„äº§ |
| çœŸé’±æŒ‡æ•° | ç»è¥ç°é‡‘æµ/å‡€åˆ©æ¶¦ï¼Œè¡¡é‡åˆ©æ¶¦è´¨é‡ |
| ç™¾åˆ†ä½ | å½“å‰å€¼åœ¨å†å²ä¸­çš„ä½ç½® |

---

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0  
**æœ€åæ›´æ–°**: 2026-02-28  
**ç»´æŠ¤è€…**: å¼€å‘å›¢é˜Ÿ
